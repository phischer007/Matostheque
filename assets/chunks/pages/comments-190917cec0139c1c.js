(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[664],{15167:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/comments",function(){return n(5816)}])},5816:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return W}});var o=n(85893),r=n(67294),s=n(9008),i=n.n(s),c=n(5616),l=n(65582),a=n(51233),d=n(15861),m=n(356),u=n(78340),x=n(66242),h=n(57709),p=n(87109),j=n(53219);n(1864);var f=n(99565),g=n(55678),Z=n(64352);let w=()=>{let e=(0,f.a)().user,[t,n]=(0,r.useState)(""),s=(0,r.useCallback)(async()=>{try{let n={user:e.user_id,content:t},o=await fetch("".concat(Z.Z.apiUrl,"/comments/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(o.ok)g.Am.success("Comment created successfully."),setTimeout(()=>{window.location.reload()},2e3);else{let e=await o.text(),t=JSON.parse(e),[n]=Object.keys(t);"".concat(n," : ").concat(t[n]),console.log(t[n]),g.Am.error("Error trying to send a new comment.",{autoClose:!1})}}catch(e){g.Am.error("Error trying to send a new comment. Try again later",{autoClose:!1})}},[t]);return(0,o.jsx)(x.Z,{sx:{p:2,flexGrow:1},children:(0,o.jsx)(h.Z,{value:t,onChange:e=>{n(e.target.value)},fullWidth:!0,multiline:!0,rows:3,placeholder:"Your comment ...",endAdornment:(0,o.jsx)(p.Z,{position:"end",children:(0,o.jsx)(j.Z,{color:"action",fontSize:"small",sx:{cursor:"pointer"},onClick:s,children:(0,o.jsx)(u.Z,{})})})})})};var y=n(45697),C=n.n(y),b=n(44267),k=n(86886),S=n(69661),_=n(34386),T=n(67720),v=n(64666),E=n(37645),A=n(6514),N=n(58951),O=n(31425),D=n(69417),P=n(64033),z=n(85783),R=n(76249),U=n(31415),B=n(50882),H=n(33931);let I=e=>{let t=e.children.length;return e.children.forEach(e=>{t+=I(e)}),t},J=e=>{let{comment:t,parentId:n}=e,s=(0,f.a)().user,i=(0,H.M)(t.created_at),l=I(t),[m,u]=(0,r.useState)(!1),[w,y]=(0,r.useState)(!1),[C,L]=(0,r.useState)(""),[W,Y]=(0,r.useState)(!1),[F,G]=(0,r.useState)(!1),M=(0,r.useCallback)(async()=>{try{(await fetch("".concat(Z.Z.apiUrl,"/comments/").concat(t.comment_id,"/"),{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok?(g.Am.success("The comment was successfully deleted",{autoClose:!1}),setTimeout(()=>{window.location.reload()},1e3)):g.Am.error("Could not delete comment, try again later",{autoClose:!1})}catch(e){g.Am.error("Could not delete comment, try again later",{autoClose:!1})}G(!1)},[W]),X=(0,r.useCallback)(()=>{y(e=>!e)}),q=(0,r.useCallback)(()=>{u(e=>!e)},[m]),K=(0,r.useCallback)(async()=>{let e={user:s.user_id,content:C,parent_comment:t.comment_id};try{let t=await fetch("".concat(Z.Z.apiUrl,"/comments/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)g.Am.success("Comment created successfully."),setTimeout(()=>{window.location.reload()},2e3);else{let e=await t.text(),n=JSON.parse(e),[o]=Object.keys(n);console.log(n[o]),g.Am.error("Error trying to send a new comment.",{autoClose:!1})}}catch(e){g.Am.error("Error trying to send a new comment. Try again later",{autoClose:!1})}},[C]);return(0,r.useEffect)(()=>{console.log(t),s.user_id==t.user&&Y(!0)},[s]),(0,o.jsxs)(x.Z,{sx:{borderRadius:"0px",border:"1px solid #ffffff",minHeight:"100px"},style:{boxShadow:"none"},children:[(0,o.jsxs)(b.Z,{sx:{pt:1,pr:n?0:1,pl:1},style:{paddingBottom:1},children:[(0,o.jsx)(c.Z,{sx:{p:1.5,borderRadius:1,alignItems:"left",display:"flex",flexDirection:"column",justifyContent:"center",backgroundColor:()=>n?"#f9f9f9":"#f5f5f5"},children:(0,o.jsxs)(k.ZP,{container:!0,xs:12,sx:{alignItems:"top"},children:[(0,o.jsx)(k.ZP,{item:!0,xs:1,lg:.8,sx:{display:{xs:"none",md:"block",lg:"block"}},children:(0,o.jsx)(S.Z,{variant:"rounded",sx:{height:60,width:60},src:""})}),(0,o.jsxs)(k.ZP,{item:!0,sx:{flexGrow:1},children:[(0,o.jsxs)(a.Z,{direction:"row",spacing:2,sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)(d.Z,{gutterBottom:!0,variant:"h6",color:"primary",sx:{fontSize:"1rem"},children:[t.user_first_name," ",t.user_last_name]}),(0,o.jsx)(d.Z,{gutterBottom:!0,variant:"caption",children:0===i?"Today":"".concat(i)})]}),(0,o.jsx)(d.Z,{gutterBottom:!0,variant:"body2",sx:{whiteSpace:"pre-line",maxHeight:{xs:"150px"},overflowY:"auto"},children:t.content}),(0,o.jsxs)(a.Z,{direction:"row",spacing:1,sx:{py:0,justifyContent:"flex-end"},children:[0!==t.children.length&&(0,o.jsxs)(o.Fragment,{children:[!m&&(0,o.jsxs)(d.Z,{variant:"caption",children:[l," comment(s)"]}),(0,o.jsx)(_.Z,{title:m?"See less":"See Thread",children:(0,o.jsx)(j.Z,{fontSize:"small",sx:{cursor:"pointer"},onClick:q,children:m?(0,o.jsx)(P.Z,{}):(0,o.jsx)(z.Z,{})})})," "]}),!F&&W&&(0,o.jsx)(j.Z,{fontSize:"small",sx:{cursor:"pointer"},onClick:()=>G(!0),children:(0,o.jsx)(R.Z,{})}),(0,o.jsx)(_.Z,{title:w?"Cancel":"Answer",children:(0,o.jsx)(j.Z,{fontSize:"small",sx:{cursor:"pointer"},onClick:X,children:w?(0,o.jsx)(U.Z,{}):(0,o.jsx)(B.Z,{})})})]})]}),w&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.Z,{}),(0,o.jsx)(k.ZP,{container:!0,xs:12,children:(0,o.jsx)(h.Z,{value:C,onChange:e=>{L(e.target.value)},multiline:!0,fullWidth:!0,minRows:1,maxRows:10,placeholder:"Your note ...",sx:{m:1},endAdornment:(0,o.jsx)(p.Z,{position:"end",children:(0,o.jsx)(j.Z,{color:"action",fontSize:"small",sx:{cursor:"pointer"},onClick:K,children:(0,o.jsx)(B.Z,{})})})})})]})]})}),m&&t.children&&t.children.map((e,n)=>(0,o.jsx)(J,{comment:e,parentId:t.comment_id},n))]}),W&&(0,o.jsx)(k.ZP,{xs:12,md:6,lg:8,children:(0,o.jsxs)(v.Z,{open:F,onClose:()=>G(!1),children:[(0,o.jsx)(E.Z,{children:"Delete Comment"}),(0,o.jsx)(A.Z,{children:(0,o.jsx)(N.Z,{children:"Are you sure you want to delete this comment?"})}),(0,o.jsxs)(O.Z,{children:[(0,o.jsx)(D.Z,{onClick:()=>G(!1),children:"Cancel"}),(0,o.jsx)(D.Z,{onClick:M,color:"error",children:"Delete"})]})]})})]})};J.propTypes={comment:C().object.isRequired};let L=()=>{let[e,t]=(0,r.useState)([]);return(0,f.a)().user,(0,r.useEffect)(()=>{fetch("".concat(Z.Z.apiUrl,"/comments/detailed/")).then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>{t(e),console.log(e)}).catch(e=>{console.error("Error fetching data:",e)})},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i(),{children:(0,o.jsx)("title",{children:"Threads"})}),(0,o.jsx)(c.Z,{component:"main",sx:{flexGrow:1,py:4},children:(0,o.jsx)(l.Z,{maxWidth:"xl",sx:{position:"relative",minHeight:"100%"},children:(0,o.jsxs)(a.Z,{container:!0,spacing:3,sx:{flexDirection:"column"},children:[(0,o.jsx)(a.Z,{direction:"row",justifyContent:"space-between",spacing:4,item:!0,children:(0,o.jsx)(a.Z,{spacing:1,children:(0,o.jsx)(d.Z,{variant:"h4",children:"@Threads"})})}),(0,o.jsx)(c.Z,{sx:{maxHeight:"615px",overflowY:"auto",scrollbarWidth:"thin","&::-ms-scrollbar":{width:"8px",backgroundColor:"rgba(0, 0, 0, 0.1)"},"&::-ms-scrollbar-thumb":{backgroundColor:"rgba(0, 0, 0, 0.2)",borderRadius:"4px"}},children:(0,o.jsx)(a.Z,{direction:"column",justifyContent:"space-between",spacing:2,sx:{boxShadow:"none"},item:!0,children:e&&e.map((e,t)=>(0,o.jsx)(J,{comment:e},t))})}),(0,o.jsx)(a.Z,{direction:"row",justifyContent:"space-between",item:!0,sx:{position:"absolute",bottom:0,width:"95%"},children:(0,o.jsx)(w,{})})]})})})]})};L.getLayout=e=>(0,o.jsx)(m.A,{children:e});var W=L},33931:function(e,t,n){"use strict";n.d(t,{M:function(){return r},p:function(){return o}});let o=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),r=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}},function(e){e.O(0,[839,294,589,740,886,911,801,356,774,888,179],function(){return e(e.s=15167)}),_N_E=e.O()}]);