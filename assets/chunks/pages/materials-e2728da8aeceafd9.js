(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[898],{3075:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/materials",function(){return r(83821)}])},36217:function(e,t,r){"use strict";r.d(t,{F:function(){return a}});var n=r(85893);r(67294);var i=r(59828);let s=i.mM.create({page:{flexDirection:"column",backgroundColor:"#FFFFFF",padding:20},row:{flexDirection:"row",justifyContent:"space-between",marginBottom:10},grid:{width:"30%",height:175,border:1,borderColor:"black",justifyContent:"center",alignItems:"center"},labelText:{fontSize:10,bottom:25},infoText:{top:-5,fontSize:9},frame:{padding:0,position:"relative",width:"80%",height:"80%",marginTop:2,border:"1 dotted black",justifyContent:"center",alignItems:"center"}}),a=e=>{let{documentData:t}=e,r=()=>{let e=[];for(let r=0;r<=t.length-1;r++){console.log(t[r]);let a="data:image/png;base64,".concat(t[r].qrCodeData),l="Matosth\xe8que-".concat(t[r].material_id.toString().padStart(3,"0"));e.push((0,n.jsxs)(i.G7,{style:s.grid,children:[(0,n.jsxs)(i.xv,{style:s.infoText,children:["Material: ",t[r].material_title]}),(0,n.jsxs)(i.G7,{style:s.frame,children:[(0,n.jsx)(i.Ee,{src:a,style:{width:"100%",height:"100%"}}),(0,n.jsx)(i.xv,{style:s.labelText,children:l})]})]},r))}return e};return(0,n.jsx)(i.BB,{children:(0,n.jsx)(i.T3,{size:"A4",style:s.page,children:(0,n.jsxs)(i.G7,{style:s.page,children:[(0,n.jsx)(i.G7,{style:s.row,children:r().slice(0,3)}),(0,n.jsx)(i.G7,{style:s.row,children:r().slice(3,6)}),(0,n.jsx)(i.G7,{style:s.row,children:r().slice(6,9)}),(0,n.jsx)(i.G7,{style:s.row,children:r().slice(9,12)})]})})})}},83821:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return X}});var n=r(85893),i=r(67294),s=r(9008),a=r.n(s),l=r(3557),o=r(88005),c=r(5616),d=r(65582),x=r(51233),h=r(15861),m=r(69417),j=r(53219),u=r(27400),p=r(10633),g=r(11589),f=r(356),y=r(45697),w=r.n(y),Z=r(82123),_=r(45286),v=r(66242),b=r(44267),C=r(23795),S=r(69661),M=r(83965),P=r(67720),q=r(41664),z=r.n(q);let D=e=>{let{material:t}=e,r=JSON.parse(t.images),i=JSON.parse(t.owner_profil),s=i?"".concat("https://liphy-annuaire.univ-grenoble-alpes.fr/static/","/").concat(i[0]):"",a=r?"".concat("https://liphy-annuaire.univ-grenoble-alpes.fr/static/","/").concat(r[0]):"";return(0,n.jsxs)(v.Z,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,n.jsx)(b.Z,{sx:{pt:1},children:(0,n.jsxs)(C.Z,{underline:"none",color:"inherit",href:"/matostheque/details/material-detail/".concat(t.material_id),children:[(0,n.jsxs)(x.Z,{xs:12,spacing:1,direction:"row",alignItems:"center",justifyContent:"flex-end",sx:{display:"flex",flexDirection:"row",p:1},children:[(0,n.jsx)(h.Z,{variant:"overline",size:"small",children:t.team}),(0,n.jsx)(S.Z,{sx:{height:40,width:40},src:s})]}),(0,n.jsx)(c.Z,{sx:{display:"flex",justifyContent:"center",pb:3},children:(0,n.jsx)(M.Z,{component:"img",alt:"Equipment Image",height:"180",image:a})}),(0,n.jsx)(h.Z,{align:"center",gutterBottom:!0,variant:"h5",children:t.material_title}),(0,n.jsx)(h.Z,{align:"center",variant:"body1",children:t.description})]})}),(0,n.jsx)(c.Z,{sx:{flexGrow:1}}),(0,n.jsx)(P.Z,{}),(0,n.jsxs)(x.Z,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:2,sx:{p:2},children:[(0,n.jsxs)(x.Z,{alignItems:"flex-start",direction:"row",spacing:1,children:[(0,n.jsx)(j.Z,{color:"action",fontSize:"small",children:(0,n.jsx)(Z.Z,{})}),(0,n.jsxs)(h.Z,{color:"text.secondary",display:"inline",variant:"body2",children:["Owner: ",t.owner_first_name," ",t.owner_last_name]})]}),(0,n.jsxs)(x.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,n.jsx)(j.Z,{color:"action",fontSize:"small",children:(0,n.jsx)(_.Z,{})}),(0,n.jsxs)(h.Z,{color:"text.secondary",display:"inline",variant:"body2",children:[t.loan_duration," Days"]})]})]})]})};D.propTypes={material:w().object.isRequired};var E=r(89396),I=r(57709),T=r(87109),G=r(93946),F=r(82313);let N=e=>{let{searchTerm:t,onSearchChange:r}=e,[s,a]=(0,i.useState)(!1),l=(0,i.useCallback)(()=>{a(!s)},[s]);return(0,n.jsxs)(v.Z,{sx:{p:2,maxWidth:800},children:[(0,n.jsxs)(x.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,n.jsx)(I.Z,{value:t,onChange:r,fullWidth:!0,placeholder:"Material name/ Material number/ Owner name/ Team/ Description",startAdornment:(0,n.jsx)(T.Z,{position:"start",children:(0,n.jsx)(j.Z,{color:"action",fontSize:"small",children:(0,n.jsx)(E.Z,{})})}),sx:{flex:1}}),(0,n.jsx)(G.Z,{onClick:l,children:(0,n.jsx)(j.Z,{fontSize:"small",children:(0,n.jsx)(F.Z,{})})})]}),s?(0,n.jsx)(x.Z,{spacing:2,sx:{my:1,p:1,bgcolor:"#f5f5f5",border:"1px solid #ccc",borderRadius:0,maxWidth:715,borderBottomRightRadius:65},children:(0,n.jsx)(h.Z,{color:"neutral.500",variant:"caption",children:"You can search a material by the material's name, the owner's name, the team name or the material number on the qrcode (ex. Matostheque-001, type 001)"})}):null]})};var k=r(64352),B=r(99565),O=r(36217),R=r(59828);R.Zx.register({family:"Montserrat",src:"https://fonts.gstatic.com/s/montserrat/v15/JTURjIg1_i6t8kCHKm45_dJE3gTD_u50.woff2"});let W=R.mM.create({page:{flexDirection:"row",alignItems:"center",justifyContent:"left",padding:20},title:{position:"absolute",top:2,fontSize:20,marginBottom:20,fontFamily:"Montserrat"},row:{flexDirection:"column",marginBottom:5,width:"100%"},cell:{borderWidth:1,borderColor:"#000",padding:5,marginBottom:20,fontFamily:"Montserrat"}}),A=e=>{let{materials:t}=e;return(0,n.jsx)(R.BB,{children:(0,n.jsxs)(R.T3,{size:"A4",style:W.page,children:[(0,n.jsxs)(R.G7,{style:W.cell,children:[(0,n.jsx)(R.xv,{style:W.title,children:"Material List"})," "]}),(0,n.jsx)(R.G7,{style:W.row,children:t.map((e,t)=>{let r="data:image/png;base64,".concat(e.qrcode),i="Matosth\xe8que-".concat(e.material_id.toString().padStart(3,"0"));return(0,n.jsx)(R.G7,{style:W.row,children:(0,n.jsxs)(R.G7,{style:W.cell,children:[(0,n.jsx)(R.Ee,{src:r,style:{width:"50px",height:"50px"}}),(0,n.jsx)(R.xv,{children:i}),(0,n.jsx)(R.xv,{children:e.material_title}),(0,n.jsxs)(R.xv,{children:[e.owner_first_name," ",e.owner_last_name]}),(0,n.jsx)(R.xv,{children:e.owner_email}),(0,n.jsx)(R.xv,{children:e.loan_duration}),(0,n.jsx)(R.xv,{children:e.code_nacre}),(0,n.jsx)(R.xv,{children:e.purchase_price})]})},t)})})]})})},L=(e,t,r)=>(0,i.useMemo)(()=>{let n=t*r;return null==e?void 0:e.slice(n,n+r)},[e,t,r]),J=(e,t)=>{let r=["material_title","owner_first_name","owner_last_name","material_id","team","description"],n=t;for(let i in isNaN(t)||(n=t.toString().padStart(3,"0")),e)if(r.includes(i)){if("string"==typeof e[i]&&e[i].toLowerCase().includes(n.toLowerCase())||"material_id"===i&&String(e[i]).padStart(3,"0")===n)return!0}else if("object"==typeof e[i]&&J(e[i],n))return!0;return!1},U=()=>{let e=(0,B.a)().user,[t,r]=(0,i.useState)(null),[s,f]=(0,i.useState)(null),[y,w]=(0,i.useState)(""),[Z,_]=(0,i.useState)(0),[v,b]=(0,i.useState)(16),[C,S]=(0,i.useState)(1),[M,P]=(0,i.useState)(null);(0,i.useEffect)(()=>{fetch("".concat(k.Z.apiUrl,"/materials/")).then(e=>e.json()).then(t=>{r(t),t&&e.is_staff&&P(t.map(e=>({qrCodeData:e.qrcode,material_id:e.material_id,material_title:e.material_title}))),S(Math.ceil(t.length/v))}).catch(e=>console.error("Error fetching data:",e))},[]),(0,i.useEffect)(()=>{let e=y?t.filter(e=>J(e,y)):t;f(e),S(Math.ceil((null==e?void 0:e.length)/v))},[y,t,v]);let q=L(s,Z,v),E=(e,t)=>{_(t-1)},I=e=>{setCardPerPage(e.target.value),_(0)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a(),{children:(0,n.jsx)("title",{children:"Materials"})}),(0,n.jsx)(c.Z,{component:"main",sx:{flexGrow:1,py:8},children:(0,n.jsx)(d.Z,{maxWidth:"xl",children:(0,n.jsxs)(x.Z,{spacing:3,children:[(0,n.jsxs)(x.Z,{direction:"row",justifyContent:"space-between",spacing:4,children:[(0,n.jsxs)(x.Z,{spacing:1,children:[(0,n.jsx)(h.Z,{variant:"h4",children:"Materials"}),e.is_staff&&(0,n.jsxs)(x.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,n.jsx)(R.WD,{document:(0,n.jsx)(A,{materials:t||[]}),fileName:"Matostheque Material List",children:e=>{let{blob:t,url:r,loading:i,error:s}=e;return(0,n.jsx)(m.Z,{color:"primary",startIcon:(0,n.jsx)(j.Z,{fontSize:"small",children:(0,n.jsx)(l.Z,{})}),style:{width:"150px"},children:"Export list"})}}),(0,n.jsx)(R.WD,{document:(0,n.jsx)(O.F,{documentData:M||[]}),fileName:"Matostheqye QRCode list",children:e=>{let{blob:t,url:r,loading:i,error:s}=e;return(0,n.jsx)(m.Z,{color:"primary",startIcon:(0,n.jsx)(j.Z,{fontSize:"small",children:(0,n.jsx)(l.Z,{})}),style:{width:"200px"},children:"Export qrcodes"})}})]})]}),(0,n.jsx)("div",{children:(0,n.jsx)(m.Z,{startIcon:(0,n.jsx)(j.Z,{fontSize:"small",children:(0,n.jsx)(o.Z,{})}),variant:"contained",component:z(),href:"/create/create-material",children:"Add"})})]}),(0,n.jsx)(N,{searchTerm:y,onSearchChange:e=>{w(e.target.value),_(0)}}),(0,n.jsx)(u.Z,{container:!0,spacing:3,children:q&&q.map(e=>(0,n.jsx)(u.Z,{xs:12,sm:6,md:4,lg:3,children:(0,n.jsx)(D,{material:e})},e.id))}),(0,n.jsx)(c.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,n.jsx)(p.Z,{count:C,size:"small",page:Z+1,onChange:E,rowsPerPage:v,onRowsPerPageChange:I,rowsPerPageOptions:[6,12,24],sx:{"& .Mui-selected":{color:"primary"}}})}),(0,n.jsx)(c.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,n.jsx)(g.Z,{component:"div",count:C,page:Z,onPageChange:E,rowsPerPage:rowsPerPage,onRowsPerPageChange:I,rowsPerPageOptions:[10,15,25,50]})})]})})})]})};U.getLayout=e=>(0,n.jsx)(f.A,{children:e});var X=U},42480:function(){}},function(e){e.O(0,[439,111,191,839,294,589,740,360,25,860,735,356,774,888,179],function(){return e(e.s=3075)}),_N_E=e.O()}]);