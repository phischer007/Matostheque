(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{75557:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(59941)}])},78175:function(e,n,a){"use strict";a.d(n,{I:function(){return s}});var r=a(85893),t=a(45697),l=a.n(t);let i=(0,a(90948).ZP)("span")(e=>{let{theme:n,ownerState:a}=e;return{alignItems:"center",backgroundColor:n.palette[a.color].alpha12,borderRadius:12,color:"dark"===n.palette.mode?n.palette[a.color].main:n.palette[a.color].dark,cursor:"default",display:"inline-flex",flexGrow:0,flexShrink:0,fontFamily:n.typography.fontFamily,fontSize:n.typography.pxToRem(12),lineHeight:2,fontWeight:600,justifyContent:"center",letterSpacing:.5,minWidth:20,paddingLeft:n.spacing(1),paddingRight:n.spacing(1),textTransform:"uppercase",whiteSpace:"nowrap"}}),s=e=>{let{color:n="primary",children:a,...t}=e;return(0,r.jsx)(i,{ownerState:{color:n},...t,children:a})};s.propTypes={children:l().node,color:l().oneOf(["primary","secondary","error","info","warning","success","amber","teal","orange","blue","gray"])}},27403:function(e,n,a){"use strict";a.d(n,{$d:function(){return o},Jb:function(){return t},Yq:function(){return s},d9:function(){return c},fo:function(){return l},ql:function(){return i},vI:function(){return r}});let r=[{value:"",label:"None"},{value:"Pending Validation",label:"Pending Validation"},{value:"Overdue",label:"Overdue"},{value:"Borrowed",label:"Borrowed"},{value:"Closed",label:"Closed"},{value:"Canceled",label:"Canceled"},{value:"Rejected",label:"Rejected"},{value:"Booked",label:"Booked"}],t={"Pending Validation":"blue",Overdue:"warning",Borrowed:"primary",Closed:"teal",Canceled:"amber",Rejected:"warning",Booked:"secondary"},l=["MOVE","LAME","BIOP","MICROTISS","ECCEL","MC2","PSM","MODI","OPTIMA","KAPAH","SECR","IT"],i=[{value:"LAB_SUPPLIES",label:"Lab Supplies"},{value:"CONSUMABLES",label:"Consumables"}],s=[{value:"FILTERS_FILTRATION_SUPPLIES",label:"Filters and Filtration Supplies"},{value:"BIOLOGICAL_CONSUMABLES",label:"Biological Consumables"},{value:"CHEMICALS",label:"Chemicals"},{value:"SAFETY_EQUIPMENT",label:"Safety Equipment"},{value:"LAB_FURNITURE_FIXTURES",label:"Lab Fixtures"},{value:"CLEANING_MAINTENANCE_SUPPLIES",label:"Cleaning and Maintenance Supplies"}],o=[{value:"GENERAL_SUPPLIES",label:"General Supplies"},{value:"BUILDINGS_INFRASTRUCTURE_WORKS_GREEN_SPACES",label:"Building, Infrastructure, Works and Green spaces"},{value:"COMMUNICATION_CULTURE_DOCUMENTATION",label:"Communication, Culture and Documentation"},{value:"TRAVEL_TRANSPORT_ACCOMMODATION",label:"Travel : Transport and Accomodation "},{value:"STUDIES_CONSULTING_INSURANCE_PI_HUMAN_RESOURCES",label:"Studies, Consulting, Insurance and Human Resources"},{value:"FREIGHT_SHIPPING_TRANSPORT_MOVING",label:"Freight, Shipping, Transport and Moving"},{value:"LABORATORY_WORKSHOP_GASES_CRYOGENICS",label:"Laboratories or Workshop Gases and Cryogenics "},{value:"HYGIENE_SAFETY",label:"Hygiene and Safety at Work"},{value:"IT_TELECOMMUNICATIONS_AUDIOVISUAL",label:"IT, Telecommunications and Audiovisual"},{value:"LABORATORY_TP_ROOM_FITTINGS",label:"Laboratory and TP Room Fittings "},{value:"ANIMAL_EXPERIMENTATION_ANIMAL_BREEDING_ANIMAL_CONSERVATION_ANIMAL_STUDIES",label:"Animal Experimentation, Animal Breeding, Animal Conservation and Animal Studies"},{value:"MEDICAL",label:"Mecidal"},{value:"MICROSCOPY_PROFILOMETRY",label:"Microscopy and Profilometry"},{value:"CHEMISTRY_BIOLOGY",label:"Chemistry and Biology"},{value:"OPTO_LASERS_OPTICAL_EQUIPMENT",label:"Opto, Lasers and Optical Equipement"},{value:"PHYSICS_NUCLEAR_CORPUSCULAR_PHYSICS",label:"Physics, Nuclear and Corpuscular Physics"},{value:"PLANT_EXPERIMENTATION",label:"Plant Experimentation"},{value:"WORKSHOP_MECHANICS_AUTOMATION",label:"Workshop, Mechanics and Automation"},{value:"SPECTROMETRY_SPECTROSCOPY_X-RAYS",label:"Spectrometry, Spectroscopy and X-rays"},{value:"ELECTRONICS_TEST_ENERGY_MEASUREMENT",label:"Electronics or Tests, Energy and Measurement"},{value:"ARTH_SCIENCES_GEOPHYSICS_ASTROPHYSICS_ARCHAEOLOGY",label:"Arth Sciences, Geophysics, Astrophysics and Archaeology"},{value:"VACUUM_VACUUM_TECHNOLOGY_EQUIPMENT",label:"Vacuum and Vacuum Technology Equipment"},{value:"NANOTECHNOLOGIES_MICROELECTRONICS",label:"Nanotechnologies and Microelectronics"},{value:"NON_PURCHASING_EXPENSES",label:"Non Purchasing Expenses"}],c=[{value:"M",label:"Meter"},{value:"KG",label:"Kilogram"},{value:"G",label:"Gram"},{value:"L",label:"Liter"},{value:"ML",label:"Milliliter"},{value:"PC",label:"Piece"}]},59941:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return es}});var r=a(85893),t=a(9008),l=a.n(t),i=a(5616),s=a(65582),o=a(27400),c=a(64666),d=a(37645),u=a(6514),h=a(58951),x=a(51233),p=a(69661),m=a(15861),j=a(31425),S=a(69417),f=a(356),_=a(67294),E=a(45697),g=a.n(E),C=a(45286),y=a(66242),b=a(44267),I=a(93946),Z=a(86886),v=a(53219),A=a(33931),O=a(5362);let T=e=>{let{data:n}=e,a=(0,A.p)(n.created_at),[t,l]=(0,_.useState)(!0);return(0,r.jsx)(r.Fragment,{children:t&&(0,r.jsx)(y.Z,{children:(0,r.jsxs)(b.Z,{sx:{p:0,pb:"0 !important"},children:[(0,r.jsxs)(x.Z,{alignItems:"flex-start",direction:"row",justifyContent:"space-between",spacing:3,children:[(0,r.jsx)(x.Z,{spacing:1,sx:{px:2,pt:1,pb:0},children:(0,r.jsx)(m.Z,{color:"text.secondary",variant:"overline",sx:{fontSize:"0.9rem"},children:"Notification"})}),(0,r.jsx)(x.Z,{children:(0,r.jsx)(I.Z,{onClick:()=>{l(!1)},color:"error",sx:{eight:47,width:47},children:(0,r.jsx)(O.Z,{})})})]}),(0,r.jsxs)(Z.ZP,{container:!0,sx:{p:2},justifyContent:"space-between",children:[(0,r.jsx)(Z.ZP,{item:!0,xs:12,sm:8,children:(0,r.jsx)(m.Z,{color:"text.primary",variant:"subtitle1",children:n.description})}),a&&(0,r.jsxs)(Z.ZP,{item:!0,xs:12,sm:4,container:!0,alignItems:"center",justifyContent:"flex-end",children:[(0,r.jsxs)(x.Z,{alignItems:"center",direction:"row",spacing:.5,sx:{px:1},children:[(0,r.jsx)(v.Z,{color:"disabled",fontSize:"smaller",children:(0,r.jsx)(C.Z,{})}),(0,r.jsx)(m.Z,{color:"text.secondary",variant:"body2",children:"Date:"})]}),(0,r.jsx)(Z.ZP,{item:!0,children:(0,r.jsx)(m.Z,{color:"text.secondary",variant:"caption",children:a})})]})]})]})})})};T.prototypes={difference:g().number,positive:g().bool,sx:g().object,value:g().string.isRequired};var N=a(52743),R=a(78445),P=a(7906),w=a(53184),L=a(53816),M=a(98102),U=a(295),G=a(67720),k=a(62023),B=a(36397),H=a(78175),Y=a(99565),D=a(41664),F=a.n(D),V=a(27403);let W=e=>{let n=(0,Y.a)().user,a=null==e?void 0:e.loans,t=null==e?void 0:e.sx,l=n.is_staff?"Latest Loans":"Your Loans";return(0,r.jsxs)(y.Z,{sx:t,children:[(0,r.jsx)(R.Z,{title:l}),(0,r.jsx)(B.L,{sx:{flexGrow:1},children:(0,r.jsx)(i.Z,{sx:{minWidth:800},children:(0,r.jsxs)(P.Z,{children:[(0,r.jsx)(w.Z,{children:(0,r.jsxs)(L.Z,{children:[(0,r.jsx)(M.Z,{children:"Material"}),(0,r.jsx)(M.Z,{children:"Owner"}),n.is_staff?(0,r.jsx)(M.Z,{sortDirection:"desc",children:"Borrower"}):(0,r.jsx)(M.Z,{sortDirection:"desc",children:"Date"}),(0,r.jsx)(M.Z,{children:"Status"})]})}),(0,r.jsx)(U.Z,{children:a?a.map(e=>{let a=(0,A.p)(e.loan_date);return(0,r.jsxs)(L.Z,{hover:!0,children:[(0,r.jsx)(M.Z,{children:e.material_title}),(0,r.jsxs)(M.Z,{children:[e.owner_first_name," ",e.owner_last_name]}),n.is_staff?(0,r.jsxs)(M.Z,{children:[e.borrower_first_name," ",e.borrower_last_name]}):(0,r.jsx)(M.Z,{children:a}),(0,r.jsx)(M.Z,{children:(0,r.jsx)(H.I,{color:V.Jb[e.loan_status],children:e.loan_status})})]},e.loan_id)}):null})]})})}),(0,r.jsx)(G.Z,{}),(0,r.jsx)(k.Z,{sx:{justifyContent:"flex-end"},children:(0,r.jsx)(S.Z,{color:"inherit",endIcon:(0,r.jsx)(v.Z,{fontSize:"small",children:(0,r.jsx)(N.Z,{})}),size:"small",variant:"text",component:F(),href:"/myloans",children:"View all"})})]})};W.prototype={orders:g().array,sx:g().object};var q=a(2141),z=a(14394),X=a(78462),K=a(70891),J=a(18987),Q=a(23795),$=a(59334),ee=a(25464),en=a(30431);let ea=e=>{let{materials:n=[],sx:a}=e,[t,l]=(0,_.useState)(null),[s,o]=(0,_.useState)(null),[c,d]=(0,_.useState)(!1),[u,h]=(0,_.useState)([]),x=(e,n)=>{l(e.currentTarget),o(n.material_id),d(n.available_for_loan)},j=()=>{l(null)};return(0,_.useEffect)(()=>{let e=[{href:"/matostheque/details/material-detail/".concat(s),label:"View Details"}];c&&e.push({href:"/matostheque/create/create-loan?materialId=".concat(s),label:"Borrow"}),h(e)},[s,c]),(0,r.jsxs)(y.Z,{sx:a,children:[(0,r.jsx)(R.Z,{title:"Latest Materials Added"}),(0,r.jsx)(X.Z,{children:n&&n.map((e,a)=>{let l=a<n.length-1,s=(0,q.Z)(new Date(e.updated_at)),o=JSON.parse(e.images),c=o?"".concat("https://liphy-annuaire.univ-grenoble-alpes.fr/static/","/").concat(o[0]):"";return(0,r.jsxs)(K.ZP,{divider:l,style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsx)(J.Z,{children:(0,r.jsx)(p.Z,{src:c,alt:"Material",sx:{height:48,width:48,borderRadius:1}})}),(0,r.jsx)(Q.Z,{style:{flexGrow:"1",marginLeft:"16px"},underline:"none",color:"inherit",href:"/matostheque/details/material-detail/".concat(e.material_id),passHref:!0,children:(0,r.jsx)($.Z,{primary:e.material_title,primaryTypographyProps:{variant:"subtitle1"},secondary:"Updated ".concat(s," ago"),secondaryTypographyProps:{variant:"body2"},sx:{cursor:"pointer"}})}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[(0,r.jsx)(i.Z,{sx:{width:15,height:15,borderRadius:1,bgcolor:()=>e.available_for_loan?e.availability?"#4caf50":"#f44336":"#808080"}}),(0,r.jsx)(I.Z,{edge:"end",onClick:n=>x(n,e),children:(0,r.jsx)(v.Z,{children:(0,r.jsx)(z.Z,{})})}),(0,r.jsx)(ee.Z,{anchorEl:t,open:!!t,onClose:j,anchorOrigin:{vertical:"right",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"left"},style:{marginLeft:"20px"},children:u.map((e,n)=>(0,r.jsx)(en.Z,{component:"a",href:e.href,children:(0,r.jsx)(m.Z,{variant:"caption",children:e.label})},n))})]})]},e.material_id)})}),(0,r.jsx)(G.Z,{}),(0,r.jsx)(k.Z,{sx:{justifyContent:"flex-end"},children:(0,r.jsx)(S.Z,{component:F(),href:"/materials",color:"inherit",endIcon:(0,r.jsx)(v.Z,{fontSize:"small",children:(0,r.jsx)(N.Z,{})}),size:"small",variant:"text",children:"View all"})})]})};ea.propTypes={materials:g().array,sx:g().object};var er=a(64352),et=a(41113),el=a(55678);let ei=()=>{let e=(0,Y.a)(),n=e.user,[a,t]=(0,_.useState)(null),[f,E]=(0,_.useState)(null),[g,C]=(0,_.useState)(null),[y,b]=(0,_.useState)(!1),[I,Z]=(0,_.useState)("user"),v=(0,_.useCallback)(async()=>{try{let a=await fetch("".concat(er.Z.apiUrl,"/users/").concat(n.user_id,"/"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:I})});if(a.ok){let n=await a.json();await e.updateUser(n.user_id),el.Am.success("Your account was successfully updated!"),window.location.reload()}else el.Am.error("An error occurred. Please try again later.",{autoClose:!1});window.sessionStorage.setItem("isNew",!1),b(!1)}catch(e){console.error("An unexpected error occurred:",e),el.Am.error("An unexpected error occurred. Please try again later.",{autoClose:!1})}},[I]),A={bgcolor:"primary.main",cursor:"pointer"};return(0,_.useEffect)(()=>{fetch("".concat(er.Z.apiUrl,"/materials/latest/")).then(e=>e.json()).then(e=>{t(e)}).catch(e=>console.error("Error fetching data:",e));let e=n.is_staff?"".concat(er.Z.apiUrl,"/loans/"):"".concat(er.Z.apiUrl,"/loans/latest/").concat(n.user_id,"/");fetch(e).then(e=>e.json()).then(e=>{E(n.is_staff?e.slice(0,5):e)}).catch(e=>console.error("Error fetching data:",e)),fetch("".concat(er.Z.apiUrl,"/notifications/important/").concat(n.user_id,"/")).then(e=>e.json()).then(e=>{e&&Array.isArray(e)&&C(e.slice(0,2))}).catch(e=>console.error("Error fetching data:",e));let a=window.sessionStorage.getItem("isNew");"true"===a&&b(a)},[n]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{children:(0,r.jsx)("title",{children:"Dashboard"})}),(0,r.jsx)(i.Z,{component:"main",sx:{flexGrow:1,py:8},children:(0,r.jsxs)(s.Z,{maxWidth:"xl",children:[(0,r.jsxs)(o.Z,{container:!0,spacing:3,direction:"column",children:[(0,r.jsx)(o.Z,{container:!0,spacing:3,lg:12,direction:"column",children:g&&g.map(e=>(0,r.jsx)(o.Z,{item:!0,xs:12,lg:6,children:(0,r.jsx)(T,{data:e})},e.notif_id))}),(0,r.jsx)(o.Z,{xs:12,sm:12,lg:10,children:(0,r.jsx)(ea,{materials:a,sx:{height:"100%"}})}),(0,r.jsx)(o.Z,{xs:12,sm:12,lg:10,children:(0,r.jsx)(W,{loans:f,sx:{height:"100%"}})})]}),y&&(0,r.jsxs)(c.Z,{open:y,onClose:()=>b(!1),disableBackdropClick:!0,disableEscapeKeyDown:!0,children:[(0,r.jsx)(d.Z,{children:"Welcome to Matostheque!"}),(0,r.jsxs)(u.Z,{children:[(0,r.jsx)(h.Z,{children:"We are happy you joined the community. Please choose the type of account you want."}),(0,r.jsxs)(o.Z,{container:!0,spacing:2,xs:12,sx:{my:2},justifyContent:"center",alignItems:"flex-start",children:[(0,r.jsx)(o.Z,{item:!0,xs:5,children:(0,r.jsxs)(x.Z,{direction:"column",alignItems:"center",justifyContent:"center",spacing:1,sx:{height:"100%"},children:[(0,r.jsx)(p.Z,{variant:"rounded",onClick:()=>{Z("user"),console.log("USER")},sx:"user"===I?{...A}:{cursor:"pointer"},children:(0,r.jsx)(et.Z,{style:{fontSize:100}})}),(0,r.jsx)(m.Z,{align:"center",children:"User"}),(0,r.jsx)(m.Z,{align:"center",variant:"caption",children:"A simple user can view the inventory and borrow equipments."})]})}),(0,r.jsx)(o.Z,{item:!0,xs:5,children:(0,r.jsxs)(x.Z,{direction:"column",alignItems:"center",justifyContent:"center",spacing:1,sx:{height:"100%"},children:[(0,r.jsx)(p.Z,{variant:"rounded",onClick:()=>{Z("owner"),console.log("OWNER")},sx:"owner"===I?{...A}:{cursor:"pointer"},children:(0,r.jsx)(et.Z,{style:{fontSize:100}})}),(0,r.jsx)(m.Z,{align:"center",children:"Owner"}),(0,r.jsx)(m.Z,{align:"center",variant:"caption",children:"An owner provides equipments he/she is willing to lend and can also borrow other equipments."})]})})]})]}),(0,r.jsx)(j.Z,{children:(0,r.jsx)(S.Z,{onClick:v,color:"error",children:"Confirm"})})]})]})})]})};ei.getLayout=e=>(0,r.jsx)(f.A,{children:e});var es=ei},33931:function(e,n,a){"use strict";a.d(n,{M:function(){return t},p:function(){return r}});let r=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),t=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}},function(e){e.O(0,[839,294,589,886,375,911,308,378,356,774,888,179],function(){return e(e.s=75557)}),_N_E=e.O()}]);