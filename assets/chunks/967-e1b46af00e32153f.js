(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[967],{36217:function(e,t,n){"use strict";n.d(t,{F:function(){return l}});var a=n(85893);n(67294);var i=n(59828);let r=i.mM.create({page:{flexDirection:"column",backgroundColor:"#FFFFFF",padding:20},row:{flexDirection:"row",justifyContent:"space-between",marginBottom:10},grid:{width:"30%",height:175,border:1,borderColor:"black",justifyContent:"center",alignItems:"center"},labelText:{fontSize:10,bottom:25},infoText:{top:-5,fontSize:9},frame:{padding:0,position:"relative",width:"80%",height:"80%",marginTop:2,border:"1 dotted black",justifyContent:"center",alignItems:"center"}}),l=e=>{let{documentData:t}=e,n=()=>{let e=[];for(let n=0;n<=t.length-1;n++){console.log(t[n]);let l="data:image/png;base64,".concat(t[n].qrCodeData),s="Matosth\xe8que-".concat(t[n].material_id.toString().padStart(3,"0"));e.push((0,a.jsxs)(i.G7,{style:r.grid,children:[(0,a.jsxs)(i.xv,{style:r.infoText,children:["Material: ",t[n].material_title]}),(0,a.jsxs)(i.G7,{style:r.frame,children:[(0,a.jsx)(i.Ee,{src:l,style:{width:"100%",height:"100%"}}),(0,a.jsx)(i.xv,{style:r.labelText,children:s})]})]},n))}return e};return(0,a.jsx)(i.BB,{children:(0,a.jsx)(i.T3,{size:"A4",style:r.page,children:(0,a.jsxs)(i.G7,{style:r.page,children:[(0,a.jsx)(i.G7,{style:r.row,children:n().slice(0,3)}),(0,a.jsx)(i.G7,{style:r.row,children:n().slice(3,6)}),(0,a.jsx)(i.G7,{style:r.row,children:n().slice(6,9)}),(0,a.jsx)(i.G7,{style:r.row,children:n().slice(9,12)})]})})})}},47834:function(e,t,n){"use strict";n.d(t,{A:function(){return g}});var a=n(85893),i=n(67294),r=n(96827);n(31517);var l=n(30381),s=n.n(l),o=n(15861),c=n(66242),d=n(44267),h=n(67720);let u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/\s+/," ").split(" ").slice(0,2).map(e=>e&&e[0].toUpperCase()).join("")},x=(0,r.Zt)(s()),m=["Borrowed","Booked","Overdue"],p=(e,t)=>{let n=e=>t?"Hidden User":u("".concat(e.borrower_details.first_name," ").concat(e.borrower_details.last_name));return e?e.map(e=>m.includes(e.loan_status)?{title:n(e),user_name:"".concat(e.borrower_details.first_name," ").concat(e.borrower_details.last_name),contact:e.borrower_details.email,location:e.location,start:new Date(e.loan_date),end:new Date(new Date(e.loan_date).getTime()+(e.duration-1)*864e5)}:null).filter(Boolean):[]},j=e=>{let{label:t,value:n}=e;return(0,a.jsxs)("tr",{style:{padding:"0px"},children:[(0,a.jsx)("td",{children:(0,a.jsx)(o.Z,{variant:"caption",color:"text.primary",children:t})}),(0,a.jsx)("td",{children:(0,a.jsx)(o.Z,{variant:"caption",color:"text.secondary",children:n})})]})},g=e=>{let t=p(e.data,e.mode),[n,l]=(0,i.useState)(!1),[s,u]=(0,i.useState)(null);return(0,a.jsxs)(c.Z,{children:[(0,a.jsx)(d.Z,{children:(0,a.jsx)(r.f,{localizer:x,events:t,tooltipAccessor:"description",startAccessor:"start",endAccessor:"end",style:{minHeight:500},onSelectEvent:(e,t)=>{u(e),l(!n)}})}),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{}),(0,a.jsx)(d.Z,{sx:{paddingY:0},children:(0,a.jsx)(o.Z,{variant:"body1",component:"div",children:(0,a.jsx)("table",{children:(0,a.jsxs)("tbody",{children:[(0,a.jsx)(j,{label:"Name:",value:s.user_name}),(0,a.jsx)(j,{label:"Contact:",value:s.contact}),(0,a.jsx)(j,{label:"Location:",value:s.location})]})})})})]})]})}},33037:function(e,t,n){"use strict";n.d(t,{x:function(){return Z}});var a=n(85893),i=n(66242),r=n(44267),l=n(5616),s=n(86886),o=n(51233),c=n(93946),d=n(69661),h=n(15861),u=n(67720),x=n(62023),m=n(69417),p=n(36217),j=n(59828),g=n(44475),f=n(84923),y=n(34386),b=n(67294),w=n(55678),v=n(12594);let Z=e=>{let t=e.data,n=t?"qr_code_".concat(t.material_id,"_ ").concat(t.material_title,".pdf"):"",Z="Matosth\xe8que-".concat(null==t?void 0:t.material_id.toString().padStart(3,"0")),_=(0,b.useCallback)(()=>{if(t.manual_link){try{new URL(t.manual_link),window.open(t.manual_link,"_blank")}catch(e){w.Am.info("The provided url is not a valid one.",{...v.M})}return}w.Am.info("No manual link provided.",{...v.M})}),C=(0,b.useCallback)(()=>{if(t.datasheet_link){try{new URL(t.datasheet_link),window.open(t.datasheet_link,"_blank")}catch(e){w.Am.info("The provided url is not a valid one.",{...v.M})}return}w.Am.info("No datasheet link provided.",{...v.M})}),k=(0,b.useCallback)(()=>{let e=window.open("","_blank");e&&(e.document.write('\n        <html>\n          <head>\n            <style>\n              body { font-family: Arial, sans-serif; text-align: center; }\n              img { margin-top: 10px; }\n              h5 { margin-top: -50px; }\n            </style>\n          </head>\n          <body>\n            <img src="data:image/png;base64,'.concat(t.qrcode,'" alt="QRCode" style="width: 250px; height: 250px; object-fit: cover;"/>\n            <h5> ').concat(Z," </h5>\n          </body>\n        </html>\n      ")),e.document.close(),e.print())},[t,Z]);return t?(0,a.jsxs)(i.Z,{children:[(0,a.jsx)(r.Z,{children:(0,a.jsxs)(l.Z,{sx:{alignItems:"center",display:"flex",flexDirection:"column",position:"relative"},children:[(0,a.jsx)(s.ZP,{container:!0,xs:12,sx:{justifyContent:"flex-end",position:"absolute"},children:(0,a.jsxs)(o.Z,{children:[(0,a.jsx)(y.Z,{title:"Manual",placement:"left",children:(0,a.jsx)(c.Z,{onClick:_,color:"primary",sx:{height:40,width:40},children:(0,a.jsx)(g.Z,{})})}),(0,a.jsx)(y.Z,{title:"Datasheet",placement:"left",children:(0,a.jsx)(c.Z,{onClick:C,color:"primary",sx:{height:40,width:40},children:(0,a.jsx)(f.Z,{})})})]})}),!e.mode&&(0,a.jsx)(d.Z,{variant:"square",sx:{height:250,width:250},children:(0,a.jsx)("img",{src:"data:image/png;base64,".concat(t.qrcode),alt:"QRCode",style:{width:"100%",height:"100%",objectFit:"cover"}})}),(0,a.jsx)(h.Z,{gutterBottom:!0,variant:"h6",children:t.material_title}),(0,a.jsx)(h.Z,{gutterBottom:!0,variant:"subtitle1",children:t.description}),(0,a.jsxs)(h.Z,{color:"text.secondary",variant:"body2",children:["Owner : ",t.owner_details.first_name," ",t.owner_details.last_name]}),(0,a.jsxs)(h.Z,{color:"text.secondary",variant:"body2",children:["Contact : ",t.owner_details.email]}),(0,a.jsxs)(h.Z,{color:"text.secondary",variant:"body2",children:["Material Number : ",Z]}),t.available_for_loan&&(0,a.jsxs)(s.ZP,{container:!0,justifyContent:"center",alignItems:"center",spacing:1,fullWidth:!0,children:[(0,a.jsx)(s.ZP,{item:!0,children:(0,a.jsx)("span",{children:t.availability?"Available":"Not Available"})}),(0,a.jsx)(s.ZP,{item:!0,children:(0,a.jsx)(l.Z,{sx:{width:15,height:15,borderRadius:1,bgcolor:t.availability?"#99FF99":"#FF9999"}})})]})]})}),!e.mode&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Z,{}),(0,a.jsxs)(x.Z,{style:{display:"flex",justifyContent:"center"},children:[(0,a.jsx)(j.WD,{document:(0,a.jsx)(p.F,{documentData:[{qrCodeData:t.qrcode,material_id:t.material_id,material_title:t.material_title}]}),fileName:n,children:e=>{let{blob:t,url:n,loading:i,error:r}=e;return(0,a.jsx)(m.Z,{fullWidth:!0,variant:"text",children:i?"Loading Document":"Print QRCode as PDF"})}}),(0,a.jsx)(m.Z,{variant:"text",onClick:k,children:"Print QRCode & Material Number"})]})]})]}):(0,a.jsx)(i.Z,{children:(0,a.jsx)(r.Z,{children:(0,a.jsx)(h.Z,{gutterBottom:!0,variant:"h5",children:"No material found!!"})})})}},70598:function(e,t,n){"use strict";n.d(t,{N:function(){return w}});var a=n(85893),i=n(67294),r=n(66242),l=n(44267),s=n(5616),o=n(65450),c=n(89007),d=n(15861),h=n(67720),u=n(62023),x=n(69417),m=n(99565),p=n(42952),j=n(75012),g=n(55678),f=n(64352),y=n(40221);let b=async e=>{let t=[];for(let n of e)try{let e=await (0,y.Z)(n,{maxSizeMB:.5,maxWidthOrHeight:1920,useWebWorker:!0});t.push(e)}catch(e){console.error("Image compression failed:",e)}return t},w=e=>{let t=e.data?JSON.parse(e.data):null,[n,y]=(0,i.useState)([]),[w,v]=(0,i.useState)(!1),Z=(0,m.a)().user,_=null==e?void 0:e.id,[C,k]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(Z.user_id==e.owner||Z.is_staff)&&k(!0)},[e]);let F=(0,i.useCallback)(async()=>{if(0===n.length){g.Am.error("No pictures to upload!",{autoClose:!1});return}let e=Array.from(n),t=await b(e),a=new FormData;t.forEach((e,t)=>{a.append("image_".concat(t),e)});try{let e=await fetch("".concat(f.Z.apiUrl,"/materials/").concat(_,"/"),{method:"PUT",body:a});if(e.ok)await e.json(),g.Am.success("Pictures uploaded successfully!",{autoClose:!1}),window.location.reload();else{let t=await e.text(),n=JSON.parse(t);g.Am.error(n.message,{autoClose:!1})}}catch(e){g.Am.error("Error trying to upload pictures: ".concat(e),{autoClose:!1})}},[n]);return(0,a.jsxs)(r.Z,{children:[t?(0,a.jsx)(l.Z,{sx:{p:0},children:(0,a.jsx)(s.Z,{sx:{alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,a.jsx)(o.Z,{sx:{width:500},cols:Math.min(t.length,3),children:t.map((e,t)=>(0,a.jsx)(c.Z,{sx:{minHeight:300},children:(0,a.jsx)("img",{srcSet:"".concat("https://liphy-annuaire.univ-grenoble-alpes.fr/static/","/").concat(e),src:"".concat("https://liphy-annuaire.univ-grenoble-alpes.fr/static/","/").concat(e),alt:"Pictures of the material",loading:"lazy"})},t))})})}):(0,a.jsx)(l.Z,{children:(0,a.jsx)(d.Z,{gutterBottom:!0,variant:"h6",children:"No pictures added yet."})}),(0,a.jsx)(h.Z,{}),C?(0,a.jsxs)(u.Z,{sx:{justifyContent:"space-between"},children:[(0,a.jsxs)(x.Z,{variant:"text",component:"label",htmlFor:"upload-button",color:w?"success":"primary",sx:{paddingX:0,display:"flex",alignItems:"center",gap:1,marginRight:1},children:[w?(0,a.jsx)(j.Z,{width:"25px",height:"25px",sx:{color:"success.main"}}):(0,a.jsx)(p.Z,{width:"25px",height:"25px"}),(0,a.jsx)("span",{style:{width:"120px"},children:w?"Files Selected":"Choose Pictures"}),(0,a.jsx)("input",{id:"upload-button",type:"file",multiple:!0,accept:"image/*",onChange:e=>{e.target.files&&e.target.files.length>0?(v(!0),y([...e.target.files])):v(!1)},style:{display:"none"}})]}),(0,a.jsx)(x.Z,{onClick:F,variant:"contained",children:"Upload"})]}):null]})}},12594:function(e,t,n){"use strict";n.d(t,{M:function(){return a}});let a={autoClose:2e3,hideProgressBar:!0,closeOnClick:!0,draggable:!0,progress:void 0}},42480:function(){}}]);